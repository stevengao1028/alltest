select  distinct * from profit where StockCode in (select distinct StockCode from profit where cast(NetMargin as int)>20 and cast(GrossMargin as int)>cast(NetMargin as int) and year =2009 and quarter = 4 and StockCode in (select distinct StockCode from profit where cast(NetMargin as int)>20 and cast(GrossMargin as int)>cast(NetMargin as int) and year =2010 and quarter = 4 and StockCode in (select distinct StockCode from profit where cast(NetMargin as int)>20 and cast(GrossMargin as int)>cast(NetMargin as int) and year =2011 and quarter = 4 and StockCode in (select distinct StockCode from profit where cast(NetMargin as int)>20 and cast(GrossMargin as int)>cast(NetMargin as int) and year =2012 and quarter = 4 and StockCode in (select distinct StockCode from profit where cast(NetMargin as int)>20 and cast(GrossMargin as int)>cast(NetMargin as int) and year =2013 and quarter = 4))))) and year >2008 and quarter =4 order by StockCode,year 
